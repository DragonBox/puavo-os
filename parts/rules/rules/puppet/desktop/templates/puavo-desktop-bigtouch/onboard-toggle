#!/bin/sh

set -eu

timestamppath=~/.onboard-toggle.invoked

current_time=$(date +%s)
latest_invocation=$(stat -c %Y "$timestamppath" 2>/dev/null || echo 0)

if [ "$(($current_time - $latest_invocation))" -ge 2 ]; then
    touch "$timestamppath"
    dbus-send --session --type=method_call --dest=org.onboard.Onboard \
              /org/onboard/Onboard/Keyboard                           \
              org.onboard.Onboard.Keyboard.ToggleVisible
fi
