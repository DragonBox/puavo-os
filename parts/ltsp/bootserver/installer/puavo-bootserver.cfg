## Preseeds for Opinsys Puavo Boot Server Installer
##
## Requirements:
## - Ubuntu Precise Pangolin 12.04.1 Server install ISO
## - auto-install/enable=true

### LOCALE_BEGIN

d-i debian-installer/locale string en_US.UTF-8

d-i console-setup/ask_detect boolean false
d-i console-setup/layoutcode string fi
d-i console-setup/variantcode string fi

### LOCALE_END

### NETWORK_BEGIN

## In case we are listening to a really slow DHCP-server.
d-i netcfg/dhcp_timeout string 60
## Either hard code the primary interface ...
d-i netcfg/choose_interface select eth0
## ... or let netcfg choose the first one with a link.
# d-i netcfg/choose_interface select auto
d-i netcfg/get_hostname string anomuumi

### NETWORK_END

### USER_BEGIN

d-i passwd/user-fullname string opinsys
d-i passwd/username string opinsys
d-i passwd/user-password password opinsys
d-i passwd/user-password-again password opinsys
d-i user-setup/allow-password-weak boolean true
d-i user-setup/encrypt-home boolean false

### USER_END

### TIME_BEGIN

d-i time/zone string Europe/Helsinki
d-i clock-setup/ntp boolean true

### TIME_END

### PARTITIONING_BEGIN

d-i partman-md/confirm boolean true
d-i partman-md/device_remove_md boolean true
d-i partman-md/confirm_nooverwrite boolean true
d-i partman-lvm/confirm boolean true
d-i partman-lvm/device_remove_lvm boolean true

d-i partman-auto/disk string /dev/sda /dev/sdb
d-i partman-auto/method string raid
d-i partman-auto/choose_recipe select boot-root
d-i partman-auto-lvm/new_vg_name string main
d-i partman-auto-lvm/guided_size string max
d-i partman-auto/expert_recipe string \
    boot-root ::                      \
        100000 20 850000 raid         \
            $lvmignore{ }             \
            $primary{ }               \
            method{ raid }            \
        .                             \
        150000 30 155000 raid         \
            $lvmignore{ }             \
            method{ raid }            \
        .                             \
        1000 10 100000000 raid        \
            $lvmignore{ }             \
            method{ raid }            \
        .                             \
        16000 60 16000 swap           \
            $defaultignore{ }         \
            $lvmok{ }                 \
            lv_name{ swap }           \
            method{ swap }            \
            format{ }                 \
        .                             \
        19000 50 20000 ext4           \
            $defaultignore{ }         \
            $lvmok{ }                 \
            $primary{ }               \
            $bootable{ }              \
            lv_name{ root }           \
            method{ format }          \
            format{ }                 \
            use_filesystem{ }         \
            filesystem{ ext4 }        \
            mountpoint{ / }           \
        .

d-i partman-auto-raid/recipe string \
    1 2 0 lvm -                     \
          /dev/sda1#/dev/sdb1       \
    .                               \
    1 2 0 ext4 /tmp/dummy-ltsp      \
          /dev/sda5#/dev/sdb5       \
    .                               \
    1 2 0 ext4 /tmp/dummy-slow      \
          /dev/sda6#/dev/sdb6       \
    .                               

# Finish and confirm partitioning.
d-i partman/choose_partition select finish
d-i partman/confirm boolean true

# Empty string, no proxy.
d-i mirror/http/proxy string
d-i clock-setup/utc boolean true

# No automatic updates.
d-i pkgsel/update-policy select none
d-i pkgsel/install-language-support boolean false

# Full-upgrade after install.
d-i pkgsel/upgrade select full-upgrade

# There's only one OS.
d-i grub-installer/only_debian boolean true

# Reboot after install.
d-i finish-install/reboot_in_progress note

tasksel tasksel/first multiselect ubuntu-server

### PARTITIONING_END
