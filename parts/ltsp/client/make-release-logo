#!/bin/sh

set -eu

release=$(cat /etc/ltsp/this_ltspimage_release)
hosttype=$(cat /etc/puavo/hosttype)
hosttype=$(echo -n "${hosttype}" | tr [:lower:] [:upper:])

if [ -f /usr/share/icons/vendor_logo.png ]; then
    convert -font Ubuntu-R -gravity center -background transparent \
        -matte -bordercolor none -border 35 \
        \( -gravity center -resize 100x /usr/share/icons/vendor_logo.png \) \
        \( pango:"<span foreground=\"#41786b\" font-size=\"x-small\">${hosttype}</span>" \) \
        \( pango:"<span foreground=\"#41786b\" font-size=\"x-small\">${release}</span>" \) \
        -append /usr/share/icons/release_logo.png

    if [ -f /opt/webmenu/styles/theme/default/img/logo.png ]; then
        mkdir -p /opt/webmenu/styles/theme/default/img/
        cp /usr/share/icons/release_logo.png /opt/webmenu/styles/theme/default/img/logo.png
    fi
fi

exit 0
