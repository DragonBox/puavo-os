set_systemd_default_target()
{
    local screen_mode
    local hosttype

    screen_mode=$(puavo-conf puavo.screen.mode)

    case "${screen_mode}" in
        infotv|webkiosk|login)
	    systemctl set-default graphical.target
	    ;;
	darkdm)
	    systemctl set-default multi-user.target
	    ;;
        auto)
            hosttype=$(puavo-conf puavo.hosttype)
            case "${hosttype}" in
                fatclient|laptop|thinclient)
                    systemctl set-default graphical.target
                    ;;
                *)
                    systemctl set-default multi-user.target
                    ;;
            esac
            ;;
        *)
            echo "Error: invalid puavo.screen.mode value '${screen_mode}'" >&2
            ;;
    esac
}

set_systemd_default_target
